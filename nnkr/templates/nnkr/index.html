{% extends 'nnkr/base.html' %}
{% block content %}

<div class="pt-3">
  <h3 class="text-center"><b>問題一覧</b></h3><hr>
</div>

<div class="album py-1">
  <div class="container">
    <div class="row">
      <!-- 問題一覧 -->
      <div class="col-lg-8 col-md-10 col-sm-12"> 
        <div class="bg-white"> 
          {% for question in questions %}

            <!-- Modal -->
            <div class="modal fade" id='{{ "imgModal-"|addstr:forloop.counter }}' tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-dialog-fluid">
                <div class="modal-content">
                  <div class="modal-body">
                    <a data-bs-dismiss="modal">
                      <div id="image" class="as-outer">
                        <div class="as-inner">
                        <img  class="card-img-top"
                          src="{{ question.image.url }}" alt="何切る画像"
                          style="width:100%;height:100%;object-fit:contain">
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- カード -->
            <div class="card mb-2 shadow-sm" style="background:#f5f5f5">
              <div class="row">
                
                <!-- 画像 -->
                <div class="col-4 my-auto">
                  <div class="as-outer">
                    <div class="as-inner">
                      <a data-bs-toggle="modal" data-bs-target='{{"#imgModal-"|addstr:forloop.counter}}' style="cursor:pointer">
                        <img  class="card-img-top"
                          src="{{ question.image.url }}" alt="何切る画像"
                          style="width:100%;height:100%;object-fit:contain">
                      </a>
                    </div>
                  </div>
                </div>

                <!-- その他 -->
                <div class="col-8">
                  <div class="card-body">
                    <a  class="link-dark-nu" href="{% url 'nnkr:detail' question.id %}">
                      <h5 class="card-title" style="display:inline;">{{question.title}}</h5>
                    </a>
                    <br>
                    <div class="d-none d-lg-block">
                      {{question.description | truncatechars:65}}
                    </div>

                    <div class="d-flex justify-content-between align-items-center">
                      <div class="left-aria">
                        <small>投票</small>{{question.votes}}
                        <small>コメ</small>{{question.comments.all|length}}
                      </div>
                      <div class="right-aria">
                        <small class="text-muted"><a class="link-dark-u" href="{% url 'user:detail' question.author.id %}">[{{question.author}}]</a></small>
                        <small class="text-muted">{{question.updated_datetime|date:"y年m月j日H:i"}}</small>
                      </div>
                    </div>

                  </div>
                </div>

              </div>
            </div>
          {% empty %}
            問題がありません
          {% endfor %}
        </div>
        <small>※画像クリックで拡大表示</small>

        <!-- ページング -->
        <div class="p-2">
          {% include "nnkr/pagination.html" with page_obj=questions %}
        </div>
      
      </div>

      <!-- 人気タグ -->
      <div class="col-lg-4 col-md-12 d-lg-block">
        <div class="border border-2 bg-gray mb-2 p-1">
          <div class="text-center">
            <h5 style="display:inline-block;">人気タグ</h5>
            <small><a>(タグ一覧)</a></small>
          </div>
          {% for tag in tags %}
            <a class="tag-box link-dark-nu shadow-sm" href="{% url 'nnkr:tag_question' tag.id %}">
              <i class="bi bi-tag" style="font-size: 1rem;"></i>
              {{tag.name}}({{tag.questions.all|length}})
            </a>
          {% endfor %}
        </div>
      </div>

    </div>
  </div>
  

</div>
{% endblock %}